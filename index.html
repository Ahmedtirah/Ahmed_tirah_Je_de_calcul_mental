<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jeu de calcul mental</title>
  </head>
  <body>
    <div id="game">
      <div id="operation">Premiere operation</div>
      <input id="reponse" placeholder="Votre rÃ©ponse" />
      <button id="valider">Valider</button>
      <div id="scorescreen">
        <div>Score: <span id="score">0</span></div>
        <div>Best: <span id="best">0</span></div>
        <div>Time: <span id="timer">10</span>s</div>
      </div>
    </div>
    <script>
      function calculer(a, op, b) {
        switch (op) {
          case "+":
            return a + b;
          case "-":
            return a - b;
          case "*":
            return a * b;
          case "/":
            return a / b;
        }
      }
      function rand(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }
      const operationelement = document.getElementById("operation");
      const reponseelement = document.getElementById("reponse");
      const scoreelement = document.getElementById("score");
      const bestelement = document.getElementById("best");
      const timerelement = document.getElementById("timer");
      let reponsecorrect;
      let score = 0;
      let timeleft = 10;
      let timerid;
      const bestkey = "";
      let best = Number(localStorage.getItem(bestkey) || 0);
      bestelement.textContent = best;
      function newop() {
        const operations = ["+", "-", "*", "/"];
        const op = operations[rand(0, 3)];
        let a = rand(1, 10);
        let b = rand(1, 10);
        if (op == "/") {
          a = a * b;
        }
        reponsecorrect = calculer(a, op, b);
        operationelement.textContent = a + " " + op + " " + b;
        timeleft = 10;
        timerelement.textContent = timeleft;
        if (timerid) clearInterval(timerid);
        timerid = setInterval(() => {
          timeleft--;
          timerelement.textContent = timeleft;
          if (timeleft <= 0) {
            clearInterval(timerid);
            reponseelement.value = "";
            newop();
          }
        }, 1000);
      }
      function valider() {
        if (reponseelement.value == reponsecorrect) {
          score++;
        }
        scoreelement.textContent = score;
        reponseelement.value = "";
        if (score > best) {
          best = score;
          bestelement.textContent = best;
          localStorage.setItem(bestkey, best);
        }
        newop();
      }
      document.getElementById("valider").onclick = valider;
      reponseelement.addEventListener("keydown", (e) => {
        if (e.key === "Enter") valider();
      });
      newop();
    </script>
  </body>
</html>
